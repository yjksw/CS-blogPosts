# [머신러닝] 딥러닝 영화 개인화 추천 - Part.3

영화 개인화 추천 포스트의 마지막 파트이다. 이전까지는 데이터를 입력받아서 전처리하고, 모델을 구축하여 학습의 원리에 대해서 간략하게 알아보았다. 결국 학습을 하면서 loss 값을 optimizing 하는 과정에서 학습된 사용자의 영화에 대한 예측 평점인 y_hat이 출력되는 것인데, 검증셋에 대해서 출력된 y_hat의 값에 대해서 어느 정도의 후처리를 하여 사용자에게 추천할 영화 리스트를 선별하는 작업이 필요하다. 이번 포스트는 학습된 모델을 가지고 검증 및 테스트를 진행한 후에 모델에서 출력한 예측 평점에 대해서 사용자에게 추천할 영화 리스트를 추출하는 작업에 대해서 이야기해보자. 



## 개요

**전체적인 검증 및 테스트 과정은 다음과 같다. **

1. 모델을 포팅해 사용자와 추천 영화 갯수를 입력한다. 
2. 영화 목록이 들어가있는 입력 데이터를 모델에 넣어 prediction을 진행한다. 
3. 모델에서 나온 예측값과 movieId 가 있는 데이터를 concat 하여 이어붙인다. 
4. movies.csv 파일에 있는 영화 아이디별 영화 제목을 불러서 3번 데이터에 concat 한다. 
5. 예측 평점을 기준으로 sorting 하여 내림차순 정렬을 한다. 
6. 1번에서 입력된 영화 갯수만큼 잘라서 영화 제목을 출력해준다. 



## 세부 구현





**<small> [참고 자료]: https://jyoondev.tistory.com/65 </small>**



